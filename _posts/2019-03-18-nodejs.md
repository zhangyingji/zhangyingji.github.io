---
layout:     post
title:      "nodejs"
subtitle:   "学习笔记"
date:       2019-03-18 15:27:00
author:     "zhangyingji"
header-img: "img/post-bg-2015.jpg"
catalog: true
tags:
    - 后台
---

# 前言

关于智能社nodejs的学习笔记

# http模块

```javascript
// 引入
const http = require('http');

let server = http.createServer((req,res) => {
	res.write('abc');
	res.end();
});

// 监听8080
server.listen(8080)
```

# fs文件模块

```javascript
const fs = require('fs')

// 读文件，readFile
fs.readFile(fileName,(err,data )=> {})

// 写文件，writeFile
fs.writeFile((文件名，内容，err => {})
```

# http数据解析

## get

解析url中的query，有三种方法：
- split手动切割（麻烦） 
- query Strings模块，解析形如a=1&b=2的url
- **url模块**，解析形如aaa?a=1&b=2的url

### Query Strings模块

```javascript
const querystring = require('querystring');

// req.url => index.html?user=xiaoming&age=12
// 如果存在query
if(req.url.indexOf('?')!=-1) {
    let arr = req.url.split('?');
    let url = arr[0];
    
    // parse(查询序列)
    GET = querystring.parse(arr[1]); // {'user': 'xiaoming','age': '12'}
} else {
    let url = req.url;
}

```

### url模块

```javascript
const urlLib = require('url');

// parse(完整url,true) 第二个参数为true时解析query为json
let queryObj = urlLib.parse(req.url, true);
// 请求路径pathname
let url = queryObj.pathname
// 请求序列query
let GET = queryObj.query
```

## post

```javascript
// 比如接收一大段文本
let str = ''
// data 有一段数据到达
req.on('data',data => {
    str += data
})

// end 数据全部到到达
req.on('end',() => {
    // 请求序列
    let POST = queryString.parse(str)
})
```